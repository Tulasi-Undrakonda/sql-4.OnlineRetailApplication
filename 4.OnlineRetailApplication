USE OnlineRetailApplication;

-- 1ï¸âƒ£ Count total customers
SELECT COUNT(*) AS total_customers
FROM customers;

-- 2ï¸âƒ£ Count number of orders per customer
SELECT customer_id, COUNT(*) AS total_orders
FROM orders
GROUP BY customer_id;

-- 3ï¸âƒ£ Total sales (sum of all orders)
SELECT SUM(total_amount) AS total_sales
FROM orders;

-- 4ï¸âƒ£ Average order amount
SELECT AVG(total_amount) AS average_order_amount
FROM orders;

-- 5ï¸âƒ£ Maximum and minimum order amounts
SELECT MAX(total_amount) AS max_order, MIN(total_amount) AS min_order
FROM orders;

-- 6ï¸âƒ£ Total quantity of products in each category
SELECT c.category_name, SUM(p.stock_quantity) AS total_stock
FROM products p
JOIN categories c ON p.category_id = c.category_id
GROUP BY c.category_name;

-- 7ï¸âƒ£ Average product price per category
SELECT c.category_name, AVG(p.price) AS avg_price
FROM products p
JOIN categories c ON p.category_id = c.category_id
GROUP BY c.category_name;

-- 8ï¸âƒ£ Number of products per category
SELECT c.category_name, COUNT(p.product_id) AS total_products
FROM products p
JOIN categories c ON p.category_id = c.category_id
GROUP BY c.category_name;

-- 9ï¸âƒ£ Total sales per customer
SELECT o.customer_id, CONCAT(c.first_name,' ',c.last_name) AS customer_name, SUM(o.total_amount) AS total_spent
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
GROUP BY o.customer_id;

-- ðŸ”Ÿ Filter customers who spent more than 500
SELECT o.customer_id, CONCAT(c.first_name,' ',c.last_name) AS customer_name, SUM(o.total_amount) AS total_spent
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
GROUP BY o.customer_id
HAVING SUM(o.total_amount) > 500;

-- 1ï¸âƒ£1ï¸âƒ£ Count orders by status
SELECT status, COUNT(*) AS number_of_orders
FROM orders
GROUP BY status;

-- 1ï¸âƒ£2ï¸âƒ£ Total revenue from each payment method
SELECT payment_method, SUM(amount) AS total_revenue
FROM payments
GROUP BY payment_method;

-- 1ï¸âƒ£3ï¸âƒ£ Average rating for each product
SELECT p.product_name, AVG(r.rating) AS avg_rating
FROM reviews r
JOIN products p ON r.product_id = p.product_id
GROUP BY p.product_name;

-- 1ï¸âƒ£4ï¸âƒ£ Products with more than 1 review
SELECT p.product_name, COUNT(r.review_id) AS total_reviews
FROM reviews r
JOIN products p ON r.product_id = p.product_id
GROUP BY p.product_name
HAVING COUNT(r.review_id) >= 1;